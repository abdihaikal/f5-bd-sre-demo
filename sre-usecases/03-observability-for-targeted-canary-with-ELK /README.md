# Getting Started - SRE ELK Stack Deployment 
## Summary
The ELK(Elasticsearch, Logstash, Kibana) is the acronym for three open source projects. 
Elasticsearch is a search and analytics engine and Logstash is a server-side data processing pipeline that ingests data from multiple sources, transforms it and send to Elasticsearch.
Kibana let’s users visualize data with charts and graphs in Elasticsearch.
So we will use ELK to analyze app performance and visualize it on centralized dashboard to see/check easily correlation for N-S traffic and E-W traffic.<br>

![ELK_Topolgy](images/elk_topology.png)<br>


## Prerequisites
Here is needed to prepare an ELK stack server outside of the openshift cluster and you can refer this site ( https://www.digitalocean.com/community/tutorials/how-to-install-elasticsearch-logstash-and-kibana-elastic-stack-on-ubuntu-18-04 ) to install it and also see the logstash configuration ![file](./logstash.conf) used for this demo.


## Use case scenario
This use case is a part of use case#1(targeted canary) as an extension feature. If you have been followed each steps at use case#1, some configurations are already configured in openshift cluster and UUID is generated by iRule on BIG-IP when traffic is arriving at BIG-IP then it is inserting to http header. All of UUIDs with access logs are sending to ELK stack server then we can see what we want to see/check such as user location, response time by user location, response time BIG-IP and NGINX, etc.


## Setup and Configuration

1. Create HSL pool, iRule on BIG-IP<br>
 We need to create pool with ELK stack server on BIG-IP then this pool member will be used by ![iRules](./iRules) to send access logs from BIG-IP to ELK stack.<br>
 
![ELK_Pool](images/elk_pool.png)
 
_The ELK server IP address is 10.69.33.1 and 8516 port is listening to get logs so pool service port should be 8516._<br>
![ELK_Pool_Member](images/elk_pool_member.png)

_Then we need to create new VIP with bookinfo pool which created at previous case._<br>
![ELK_VIP](images/elk_vip.png)

_The new VIP name is a bookinfo-EdgeGW and the bookinfo pool is defined for default pool like below. The applied iRules name is elk_hsl_irule for this VIP so all of access logs will have the UUID and send to ELK server by this iRule._<br>
![ELK_Default_Pool](images/elk_default_pool.png)

_Hereby, it’s ready to use ELK stack for BIG-IP access logs, NGINX apps in openshift cluster but we don’t need any configuration for NGINX apps at this step why it’s already pushed at the first case in config-map._<br>
![ELK_Log](images/elk_log.png)

2. Customize Kibana Dashboard<br>
 If all of configurations are ready to use in proper, all of defined logs are saving in ELK server. We are able to customize a  dashboard to see visualized useful information which user location, response time by location etc.<br>
Let us see how it works<br>

<br>_open your browser and go to ELK server( http://x.x.x.x:5601 ) then you can see a Kibana main window like following_
![Kibana1_main](images/Kibana1_main.png)

<br>_Then press control icon from left side-menu to go to management page_
![Kibana2_management](images/Kibana2_management.png)

<br>_We can see the management page then press "Index Management" menu from the page_
![Kibana3_management_detail](images/Kibana3_management_detail.png)

<br>_Now, we can see index management page and see index name which defined them in ![logstash.conf](./logstash.conf) file._
![Kibana4_index_management](images/Kibana4_index_management.png)
<br>_You can check more detail to index manage from_ ![here](https://www.elastic.co/guide/en/kibana/current/managing-indices.html)


3. ELK Dashboard Sampels
![ELK_Pool](images/elk_map.png)


![ELK_Pool](images/elk_bigip.png)


![ELK_Pool](images/elk_response.png)


![ELK_Pool](images/elk_dot.png)




